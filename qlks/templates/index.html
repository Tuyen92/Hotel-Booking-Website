{% extends 'base/base.html' %}
{% block body %}
    <header id="home">
        <div class="small-container">
            <div class="row">
                <div class="col-lg-4 col-12 lobster-font-family d-flex align-items-center">
                    <h2>Five Hotel, fine service</h2>
                    <button><a href="#about">About hotel</a></button>
                </div>
            </div>
            <div class="h-slider roboto-font-family welcome d-flex align-items-center justify-content-center">
                <h1 class="text-capitalize lobster-font-family">Welcome {% if current_user.is_authenticated %} <span style="font-size: 65px;"> {{current_user.name}} </span> {% endif %} to <br><span>five hotel</span></h1>
                <div id="headerslider" class="carousel slide" data-ride="carousel">
                  <div class="carousel-inner">
                    <div class="carousel-item carousel-three active"></div>
                    <div class="carousel-item carousel-two"></div>
                    <div class="carousel-item carousel-one"></div>
                  </div>
                  <a class="carousel-control-prev" href="#headerslider" role="button" data-slide="prev">
                    <i class="fas fa-angle-double-left"></i>
                    <span class="sr-only">Previous</span>
                  </a>
                  <a class="carousel-control-next" href="#headerslider" role="button" data-slide="next">
                    <i class="fas fa-angle-double-right"></i>
                    <span class="sr-only">Next</span>
                  </a>
                </div>
            </div>
        </div>
        <div class="st-rec"></div>
        <div class="rd-rec"></div>
    </header>

    <div class="about lobster-font-family">
        <div class="container">
            <h2 class="text-center text-capitalize" id="about">About our hotel</h2>
            <img src="../static/imgs/shape.png">
            <div class="row">
                <div class="col-lg-6 col-12">
                    <h4>A best place to enjoy your life</h4>
                    <p>Five Hotel was established in Ho Chi Minh city by Loi, Long and Tuyen on 16/1/2022. We serve our guests with 5 criterion: Commit, Friendly, Convenient, Comfortable, High-quality</p>
                </div>
                <div class="col-lg-6 col-12">
                    <div class="img"></div>
                </div>
            </div>
            <h2 class="text-capitalize" id="room">rooms & suits</h2>
            <div class="row my-3">
                {% for rt in room_type %}
                    <div class="col-lg-4 col-12">
                        <div class="img" style="background-image: url('{{ rt.img }}')"></div>
                    </div>
                    <div class="col-lg-8 col-12">
                        <div class="block">
                            <div>
                                <strong>{{ rt['type'] }} room</strong>
                                <h5>{{ rt.price }} VNƒê</h5>
                                <p>{{ rt['des'] }}</p>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="gallery lobster-font-family " id="blog">
        <div class="container">
            <h2 class="text-calitalize text-center">Our gallery</h2>
            <div class="row">
                <div class="col-lg-4 col-md-6 col-12">
                    <div class="pic-one"><h4>Relaxed swimming</h4></div>
                    <div class="pic-two"><h4>Spacious Accommodition</h4></div>
                </div>
                <div class="col-lg-4 col-md-6 col-12">
                    <div class="pic-three active"><h4>Yoga Wellness</h4></div>
                </div>
                <div class="col-lg-4 col-md-6 col-12">
                    <div class="pic-four"><h4>Dinner & Buffet</h4></div>
                    <div class="pic-five"><h4>Spa & Wellness</h4></div>
                </div>
            </div>
        </div>
    </div>

    <div class="slider main-font-family">
        <h2 class="text-center text-capitalize main-font-family">what our clients say</h2>
      <div id="slideToNext" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
          <li data-target="#slideToNext" data-slide-to="0" class="active"></li>
          <li data-target="#slideToNext" data-slide-to="1"></li>
          <li data-target="#slideToNext" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="carousel-caption d-block">
                <img src="../static/imgs/user.png">
              <h5>Loi Bui</h5>
              <p>It is a long established fact that a reader wil
l be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,</p>
            </div>
          </div>
          <div class="carousel-item">
            <div class="carousel-caption d-block">
                <img src="../static/imgs/user.png">
              <h5>Dien Long</h5>
              <p>It is a long established fact that a reader wil
l be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters,</p>
            </div>
          </div>
          <div class="carousel-item">
            <div class="carousel-caption d-block">
                <img src="../static/imgs/user.png">
              <h5>Le Tuyen</h5>
              <p>Staying in Five Hotel like staying in The Pentagon</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="contact main-font-family text-center">
        <div class="container">
            <h2 id="contact">Get in touch</h2>
            <div class="row">
                <div class="col-6">
                    <div class="contact-form">
                        <form>
                            <input type="text" placeholder="Name" id="name" name="name">
                            <input type="email" placeholder="Email">
                            <input type="text" placeholder="Phone">
                            <textarea placeholder="Message" id="cmt" name="cmt"></textarea>
                            <input type="submit" value="submit">
                        </form>
                    </div>
                </div>
                <div class="col-6">
                    <h2 class="text-right">Book Your Holiday Best for relaxed retreats and cultural encounters</h2>
                    <img src="../static/imgs/shape.png">
                </div>
            </div>
        </div>
        <div></div>
    </div>

    <footer class="noto-font-family">
        <div class="overlay">
            <div class="container">
                <div class="row">
                    <div class="col-lg-4 col-md-6 col-12">
                        <h3>Useful links</h3>
                        <ul class="text-capitalize">
                            <li><a href="#">Home</a></li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#room">Rooms</a></li>
                            <li><a href="#">Blog</a></li>
                            <li><a href="#contact">Contacts</a></li>
                        </ul>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12">
                        <h3>Find us</h3>
                        <p>Landmark81, Block L1, Nguyen Huu Canh Street,<br>
                            Viet Nam, Ho Chi Minh City, District Binh Thanh<br>
                            (+84) 909 999 999<br>
                            (+84) 906 666 666<br>
                            fivehotel@gmail.com
                        </p>
                    </div>
                    <div class="col-lg-4 col-md-6 col-12 form">
                        <h3>News letter</h3>
                        <form>
                            <input type="email" placeholder="Email">
                            <input type="submit">
                        </form>
                        <ul>
                            <li><a href="https://www.facebook.com" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
                            <li><a href="https://www.twitter.com" target="_blank"><i class="fab fa-twitter"></i></a></li>
                            <li><a href="https://www.instagram.com" target="_blank"><i class="fab fa-instagram"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>

<script src="../static/js/jquery-3.3.1.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script>
    $(function () {

        'use strict';

        var winH = $(window).height();

        $('header').height(winH);

        $('.navbar ul.navbar-nav li a').on('click', function (e) {

            var getAttr = $(this).attr('href');
            getAttr = getAttr.substring(getAttr.indexOf("/")+1)

            $('html').animate({scrollTop: $(getAttr).offset().top}, 1000);
        });
    });
</script>

<div class="container-fluid d-none fixed-top book-dialog" style="height: 100%; background-color: rgba(0, 0, 0, 0.5);">
    <div class="container position-absolute bg-light overflow-auto" style="height:95%; top:50%; left:50%; transform: translateY(-50%) translateX(-50%)">
        <h1 class="text-center" style="margin-top: 1rem; color: #CC0000; font-family: 'Lobster Two', cursive;">Book a room</h1>
        <div class="col-md-7 mx-auto my-2" style="font-family: 'Lobster Two', cursive;">
            <form method="post" action="{{ url_for('book_room') }}">
                <div class="form-group">
                    <label for="date-rent">Date start to rent:</label>
                    <input type="date" class="form-control" placeholder="Enter username" id="date-rent" name="date-rent" required>
                </div>
                <div class="form-group">
                    <label for="date-end">Date end:</label>
                    <input type="date" class="form-control" placeholder="Enter password" id="date-end" name="date-end" required>
                </div>
                <div class="form-group">
                    <label for="number-of-people">Number of people:</label>
                    <input type="number" class="form-control" placeholder="Enter number of people" id="number-of-people" name="number-of-people" required>
                </div>
                <div class="form-group">
                    <label for="foreign">Number of foreign people:</label>
                    <input type="number" class="form-control" placeholder="Enter number of foreign people" id="foreign" name="foreign">
                </div>
                <div class="form-group">
                    <label for="customer-id">Customer id:</label>
                    <input type="number" class="form-control" placeholder="Enter customer id" id="customer-id" name="customer-id">
                </div>
                <div class="form-group">
                    <label for="customer-name">Customer name:</label>
                    <input type="text" class="form-control" placeholder="Enter customer name" id="customer-name" name="customer-name">
                </div>
                <div class="form-group">
                    <label for="room-id">Room:</label>
                    <select name="room-id" class="custom-select" id="room-id">
                        <option selected>Please select a room</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-danger submit">Book</button>
                <button type="button" class="btn btn-secondary cancel">Cancel</button>
            </form>
        </div>
    </div>
</div>

<div class="container-fluid d-none fixed-top rent-dialog" style="height: 100%; background-color: rgba(0, 0, 0, 0.5);">
    <div class="container position-absolute bg-light overflow-auto" style="height:95%; top:50%; left:50%; transform: translateY(-50%) translateX(-50%)">
        <h1 class="text-center" style="margin-top: 1rem; color: #CC0000; font-family: 'Lobster Two', cursive;">Rent a room</h1>
        <div class="col-md-7 mx-auto my-2" style="font-family: 'Lobster Two', cursive;">
            <form method="post" action="{{ url_for('rent_room') }}">
                <div class="form-group">
                    <label for="date-rent-2">Date start to rent:</label>
                    <input type="date" class="form-control" placeholder="Enter username" id="date-rent-2" name="date-rent-2" required>
                </div>
                <div class="form-group">
                    <label for="date-end-2">Date end:</label>
                    <input type="date" class="form-control" placeholder="Enter password" id="date-end-2" name="date-end-2" required>
                </div>
                <div class="form-group">
                    <label for="number-of-people-2">Number of people:</label>
                    <input type="number" class="form-control" placeholder="Enter number of people" id="number-of-people-2" name="number-of-people-2" required>
                </div>
                <div class="form-group">
                    <label for="foreign-2">Number of foreign people:</label>
                    <input type="number" class="form-control" placeholder="Enter number of foreign people" id="foreign-2" name="foreign-2">
                </div>
                <div class="form-group">
                    <label for="customer-id-2">Customer id:</label>
                    <input type="number" class="form-control" placeholder="Enter customer id" id="customer-id-2" name="customer-id-2">
                </div>
                <div class="form-group">
                    <label for="customer-name-2">Customer name:</label>
                    <input type="text" class="form-control" placeholder="Enter customer name" id="customer-name-2" name="customer-name-2">
                </div>
                <div class="form-group">
                    <label for="room-id-2">Room:</label>
                    <select name="room-id-2" class="custom-select" id="room-id-2">
                        <option selected>Please select a room</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-danger submit">Rent</button>
                <button type="button" class="btn btn-secondary cancel">Cancel</button>
            </form>
        </div>
    </div>
</div>

<div class="container-fluid d-none fixed-top find-dialog" style="height: 100%; background-color: rgba(0, 0, 0, 0.5);">
    <div class="container position-absolute bg-light" style="top:50%; left:50%; transform: translateY(-50%) translateX(-50%)">
        <h1 class="text-center" style="margin-top: 1rem; color: #CC0000; font-family: 'Lobster Two', cursive;">Find a room</h1>
        <div class="col-md-7 mx-auto my-2" style="font-family: 'Lobster Two', cursive;">
            <form method="post" action="{{ url_for('find_room') }}">
                <div class="form-group">
                    <label for="price">Room price:</label>
                    <input type="number" class="form-control" placeholder="Enter price you want" id="price" name="price">
                </div>
                <div class="form-group">
                    <label for="floor">Room at floor:</label>
                    <input type="number" class="form-control" placeholder="Enter the floor you want" id="floor" name="floor">
                </div>
                {% if current_user.is_authenticated and current_user.user_role_id.__eq__(2) %}
                    <button type="submit" class="btn btn-danger f-book">Find & Book</button>
                    <button type="submit" class="btn btn-danger f-rent">Find & Rent</button>
                {% else %}
                    <button type="submit" class="btn btn-danger submit">Find</button>
                {% endif %}
                    <button type="button" class="btn btn-secondary cancel">Cancel</button>
            </form>
        </div>
    </div>
</div>

<script>
    $(".booking").click(function () {
        $(".find-dialog").removeClass("d-none");
        $("body").css("overflow", "hidden");
    });

    $(".book-dialog .cancel").click(function () {
        $(".book-dialog").addClass("d-none");
        $("body").css("overflow", "scroll");
    });

    $(".find-dialog .cancel").click(function () {
        $(".find-dialog").addClass("d-none");
        $("body").css("overflow", "scroll");
    });

    $(".find-dialog .submit").click(function (e) {
        e.preventDefault();

        let price = parseInt($("#price").val());
        let floor = parseInt($("#floor").val());

        fetch('/api/find-room', {
            method: 'post',
            body: JSON.stringify({
                "price": price,
                "floor": floor
            }),
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function(res) {
            console.info(res)
            return res.json()
        }).then(function(dt){
            console.info(dt)

            var list = document.getElementById("room-id");
            list.innerHTML = '<option selected>Please select a room</option>';

            for (var i = 0; i < dt.length; i++) {
                var node = document.createElement("option");
                node.value = dt[i];
                var textnode = document.createTextNode("Room " + dt[i]);
                node.appendChild(textnode);
                document.getElementById("room-id").appendChild(node);
            }
        }).catch(function(err){
            console.info(err)
        })

        $(".find-dialog").addClass("d-none");
        $(".book-dialog").removeClass("d-none");
    });

    {% if current_user.is_authenticated and current_user.user_role_id.__eq__(2) %}
    $(".find-dialog .f-rent").click(function (e) {
        e.preventDefault();

        let price = parseInt($("#price").val());
        let floor = parseInt($("#floor").val());

        fetch('/api/find-room', {
            method: 'post',
            body: JSON.stringify({
                "price": price,
                "floor": floor
            }),
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function(res) {
            console.info(res)
            return res.json()
        }).then(function(dt){
            console.info(dt)

            var list = document.getElementById("room-id");
            list.innerHTML = '<option selected>Please select a room</option>';

            for (var i = 0; i < dt.length; i++) {
                var node = document.createElement("option");
                node.value = dt[i];
                var textnode = document.createTextNode("Room " + dt[i]);
                node.appendChild(textnode);
                document.getElementById("room-id-2").appendChild(node);
            }
        }).catch(function(err){
            console.info(err)
        })

        $(".find-dialog").addClass("d-none");
        $(".rent-dialog").removeClass("d-none");
    });

    $(".find-dialog .f-book").click(function (e) {
            e.preventDefault();

        let price = parseInt($("#price").val());
        let floor = parseInt($("#floor").val());

        fetch('/api/find-room', {
            method: 'post',
            body: JSON.stringify({
                "price": price,
                "floor": floor
            }),
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function(res) {
            console.info(res)
            return res.json()
        }).then(function(dt){
            console.info(dt)

            var list = document.getElementById("room-id");
            list.innerHTML = '<option selected>Please select a room</option>';

            for (var i = 0; i < dt.length; i++) {
                var node = document.createElement("option");
                node.value = dt[i];
                var textnode = document.createTextNode("Room " + dt[i]);
                node.appendChild(textnode);
                document.getElementById("room-id").appendChild(node);
            }
        }).catch(function(err){
            console.info(err)
        })

        $(".find-dialog").addClass("d-none");
        $(".book-dialog").removeClass("d-none");
    });
    {% endif %}

    $("#room-id-2").change(function () {
        let id = parseInt($("#room-id-2").val());
        console.info($("#room-id-2").val())

        fetch('{{ url_for('auto_write') }}', {
            method: 'post',
            body: JSON.stringify({
                "id": id
            }),
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function(res) {
            console.info(res)
            return res.json()
        }).then(function(dt){
            console.info(dt)

            $("#date-rent-2").val(convert(dt[0]));
            $("#date-end-2").val(convert(dt[1]));
            $("#number-of-people-2").val(dt[2]);
            $("#foreign-2").val(dt[3]);
            $("#customer-id-2").val(dt[4]);
            $("#customer-name-2").val(dt[5]);
        }).catch(function(err){
            console.info(err)
        })
    });

    function convert(str) {
        var date = new Date(str),
            mnth = ("0" + (date.getMonth() + 1)).slice(-2),
            day = ("0" + date.getDate()).slice(-2);
        return [date.getFullYear(), mnth, day].join("-");
    }

    $(".rent-dialog .cancel").click(function () {
        $(".rent-dialog").addClass("d-none");
        $("body").css("overflow", "scroll");
    });
</script>
{% endblock %}